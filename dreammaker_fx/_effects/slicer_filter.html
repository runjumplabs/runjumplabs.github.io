---
layout: default
name: slicer_filter
effect_type: slicer-based-effects
---
<pre>
#include "afx.h"

/*

 The slicer switches between output channels at a predefined rate.  It is 
 great for creating interesting rhymic effects.  This effect sends each channel
 of the slicer through band-pass filters that are tuned to different center
 frequencies.  The outputs of the filters are then mixed together using a 
 simple 4 channel mixer.
  
               +------------+   +-------------+   +---------+
               |            +-->+ BPF @ 200Hz +-->+         |
               |            |   +-------------+   |         |
               |            |   +-------------+   |         |
               |            +-->+ BPF @ 1200Hz+-->+         |
Instr In +---->+ Slicer x 4 |   +-------------+   | Mixer4  +----> Amp Out
               |            |   +-------------+   |         |
               |            +-->+ BPF @ 500Hz +-->+         |
               |            |   +-------------+   |         |
               |            |   +-------------+   |         |
               |            +-->+ BPF @ 800Hz +-->+         |
               +------------+   +-------------+   +---------+

 */

// Set up a slicer for four channels
fx_slicer   slice4(1000.0, 4);

// Instances of the four bandpass (BPF) filters at different frequencies
fx_biquad_filter  filt1(200, FILTER_WIDTH_NARROW, BIQUAD_TYPE_BPF);
fx_biquad_filter  filt2(1000, FILTER_WIDTH_NARROW, BIQUAD_TYPE_BPF);
fx_biquad_filter  filt3(500, FILTER_WIDTH_NARROW, BIQUAD_TYPE_BPF);
fx_biquad_filter  filt4(800, FILTER_WIDTH_NARROW, BIQUAD_TYPE_BPF);
fx_mixer_4 mix4;

bool go = false;
bool running = false;

void setup() {

  pedal.init();

  pedal.route_audio(pedal.instr_in, slice4.input);
  
  pedal.route_audio(slice4.output_1, filt1.input);
  pedal.route_audio(slice4.output_2, filt2.input);
  pedal.route_audio(slice4.output_3, filt3.input);
  pedal.route_audio(slice4.output_4, filt4.input);

  pedal.route_audio(filt1.output, mix4.input_1);
  pedal.route_audio(filt2.output, mix4.input_2);
  pedal.route_audio(filt3.output, mix4.input_3);
  pedal.route_audio(filt4.output, mix4.input_4);
  
  pedal.route_audio(mix4.output, pedal.amp_out);

  // Optional code to print out the routing details to console
  if (true) {
    pedal.print_instance_stack();
    pedal.print_routing_table();
    pedal.print_param_tables();
  }

  // Run this effect
  pedal.run(); 

}

void loop() {

  static int now = millis();

  // Run pedal service to take care of stuff
  pedal.service();

  // Set period of slicer from 100ms through 3 seconds
  if (pedal.pot_0.has_changed()) {
    slice4.set_period_ms(100.0 + 3000.0 * (1.0 - pedal.pot_0.val));
  }

  if (pedal.pot_1.has_changed()) {
  }
  
  if (pedal.pot_2.has_changed()) {
  }

}

</pre>
